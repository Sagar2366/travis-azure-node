dist: trusty
sudo: required


before_install:
  - npm install -g npm@latest

cache:
  directories:
    - "node_modules"

before_install :
  - echo "starting installation of dependencies for node.js application"

addons:
  sonarcloud:
    organization: sonarcube-org 

install:
  - npm install http
  - yarn install

after_install :
  - echo "Finishing installation process successfully !"


before_script :
  - echo "Running execution script !!!"

script :
  - yarn build
  - sonar-scanner

after_script :
  - echo "Running execution script successfully !!!"
    
# before_deploy :
#   - echo "Starting deployment of node.js application on to azure provider"
#   - git add .
#   - git commit -m "adding newly generated files"
#   - git push origin master

deploy :
- provider : azure_web_apps
- verbose : true
- on:
  all_branches: true

# after_deploy :
#   - echo "Finishing deployment on to azure provider successfully !"